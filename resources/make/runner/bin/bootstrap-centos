#!/usr/bin/env bash
set -Eeuo pipefail

################################################################################
##                       !!!! DO NOT EDIT THIS FILE !!!!                      ##
##                                                                            ##
## This file is part of https://github.com/fleshgrinder/make-runner and       ##
## overwritten if you update your installation of the framework. Refer to the ##
## project documentation for more information. Contributions are welcome!     ##
##                                                                            ##
##                       !!!! DO NOT EDIT THIS FILE !!!!                      ##
################################################################################

##
## Installs recommended software for using make-runner on a CentOS system for
## maximum portability of scripts.
##

if ((EUID != 0)); then
    echo This script must be executed as superuser. >&2
    exit 77
fi

yum install -y epel-release

yum install -y \
    bash \
    coreutils \
    curl \
    device-mapper-persistent-data \
    dos2unix \
    findutils \
    gawk \
    git \
    gnupg \
    grep \
    hub \
    jq \
    lvm2 \
    make \
    readline \
    sed \
    tar \
    yum-utils

# https://docs.docker.com/install/linux/docker-ce/centos/
yum remove \
    docker \
    docker-client \
    docker-client-latest \
    docker-common \
    docker-latest \
    docker-latest-logrotate \
    docker-logrotate \
    docker-engine

# TODO how can we import the key for dnf on our own and verify the fingerprint?
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
yum install -y docker-ce docker-ce-cli containerd.io
