#!/usr/bin/env bash
set -Eeuo pipefail

################################################################################
##                       !!!! DO NOT EDIT THIS FILE !!!!                      ##
##                                                                            ##
## This file is part of https://github.com/fleshgrinder/make-runner and       ##
## overwritten if you update your installation of the framework. Refer to the ##
## project documentation for more information. Contributions are welcome!     ##
##                                                                            ##
##                       !!!! DO NOT EDIT THIS FILE !!!!                      ##
################################################################################

##
## Checks if the given command exists and prints a helpful error message if it
## cannot be found in the PATH of the users, including installation instructions
## if the operating system can be detected.
##
##     require-command foo
##     foo
##

readonly cmd=${1:?missing required argument <command>}

if ! command-exists "$cmd"; then
    for installer in apt-get brew dnf yum; do
        if command-exists "$installer"; then
            printf '%b%s%b is missing from your system. Should I try installing it via %b%s%b? [yN] ' \
                "$FG_CYAN" "$cmd" "$RESET_COLORS" \
                "$FG_CYAN" "$1" "$RESET_COLORS"

            read -r answer
            case "$answer" in
            [Yy]*) exec "$installer" install "$cmd" ;;
            *) exit "$EX_UNAVAILABLE" ;;
            esac
        fi
    done

    box-err "$cmd could not be found in your PATH, make sure it is available."
    exit "$EX_UNAVAILABLE"
fi
